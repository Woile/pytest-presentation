<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />

    <title>Pytest</title>

    <link rel="stylesheet" href="css/reset.css" />
    <link rel="stylesheet" href="css/reveal.css" />
    <link rel="stylesheet" href="css/theme/night.css" />

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/monokai.css" />

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement("link");
      link.rel = "stylesheet";
      link.type = "text/css";
      link.href = window.location.search.match(/print-pdf/gi)
        ? "css/print/pdf.css"
        : "css/print/paper.css";
      document.getElementsByTagName("head")[0].appendChild(link);
    </script>
    <style type="text/css">
      .text-red {
        color: red;
      }

      .text-green {
        color: green;
      }
      .bigger {
        font-size: 70px;
      }
      .container {
        display: flex;
      }
      .col {
        flex: 1;
      }
    </style>
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        <section>
          <h2>
            Pytest supercharged
          </h2>
        </section>

        <section>
          <h3>About testing</h3>
          <p>It is an essential part of the lifecycle of a project</p>
          <ul class="fragment">
            <li>Guarantees a certain behaviour</li>
            <li>Catch bugs early</li>
          </ul>
          <aside class="notes">
            behaviour like your business logic, failure is also business logic
          </aside>
        </section>

        <section>
          <section>
            <h3>The core of pytest</h3>
            <img src="/images/dive.gif" alt="dive into it" />
          </section>
          <section>
            <p>
              Detailed info on failing asserts
            </p>
            <div class="container">
              <div class="col">
                <pre><code>
# pytest
def test_location():
  location = get_location()
  assert (
    location == "bordeaux"
  )
  </code></pre>
              </div>
              <div class="col">
                <pre><code>
# unittest
def test_location(self):
  location = get_location()
  self.assertEqual(
    location, "bordeaux"
  )
  </code></pre>
              </div>
            </div>
            <p class="fragment">Demo 1</p>
            <aside class="notes">
              no need for unittest
            </aside>
          </section>
          <section data-markdown>
            <textarea data-template>
              ## test auto-discovery

              ```bash
              pytest path?
              ```
              ```bash
              test_*.py or *_test.py
              ```

              <aside class="notes">
                <ul>
                  <li>
                    auto find files or provide path
                  </li>
                  <li>
                    files should begin or end with test
                  </li>
                  <li>
                    class should start with Test and functions with test
                  </li>
                </ul>
              </aside>
            </textarea>
          </section>
          <section>
            <h3>Support for unittests</h3>
            <ul>
              <li>more informative tracebacks</li>
              <li>select specific tests (-k)</li>
              <li>run marked tests (-m)</li>
            </ul>
            <p class="fragment">
              Demo 2
            </p>
          </section>
        </section>

        <section>
          <section>
            <h3>Tests as documentation</h3>

            Your tests should reflect how to properly use your software
            <p class="fragment">Let's see...</p>
          </section>
          <section data-markdown>
            <textarea data-template>
              ```python
              def test_list_customers():
                data = factory_dict('Customer')

              ```
             </textarea
            >
          </section>
          <section data-markdown>
            <textarea data-template>
              ```python
              def test_list_customers():
                payload = {
                  "name": "Jon",
                  "id": 12
                }
                response = self.client.post('customers/', payload)
                assert response.status == 200
              ```
             </textarea
            >
          </section>
        </section>

        <section>
          <section>
            <h3>Fixtures</h3>
            <p>baseline upon which tests can reliably and repeatedly execute</p>
          </section>
          <section></section>
        </section>

        <section>
          <h3>Parametrize</h3>
        </section>

        <section>pytest conf</section>

        <section>
          <section>
            <h3>Mocks</h3>
          </section>
          <section>
            - Understanding mocks
          </section>
          <section>
            - Using mocks
          </section>
        </section>

        <section>
          <h3>Refactoring with tests in mind</h3>
        </section>

        <section>
          <section>
            <h3>TDD</h3>
          </section>
          <section>
            - Clear goals
            - Robust and simpler code
            - Let the tests guide you, not requirements

            ```python
            def add(a,b):
                return 4
            assert add(3, 1) == 4
            ```
          </section>
        </section>

        <section>
          <h3>Plugins</h3>
        </section>
      </div>
    </div>

    <script src="js/reveal.js"></script>

    <script>
      Reveal.registerPlugin("myPlugin", {
        init: () => {
          return new Promise(resolve => setTimeout(resolve, 3000));
        }
      });
      Reveal.addEventListener("ready", () =>
        console.log("Three seconds later...")
      );
      Reveal.initialize({
        dependencies: [
          { src: "plugin/markdown/marked.js" },
          { src: "plugin/markdown/markdown.js" },
          { src: "plugin/notes/notes.js", async: true },
          {
            src: "plugin/highlight/highlight.js",
            async: true,
            callback: function() {
              hljs.initHighlightingOnLoad();
            }
          }
        ],
        markdown: {
          smartypants: true
        },
        history: true
      });
    </script>
  </body>
</html>
